<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¦‹ç©æ›¸ä½œæˆãƒ„ãƒ¼ãƒ«</title>
    <!-- Favicon -->
    <link rel="icon" href="https://placehold.co/32x32/007bff/ffffff?text=ğŸ“‹" type="image/png">
    <!-- Apple Touch Icon (iOSãƒ›ãƒ¼ãƒ ç”»é¢ç”¨) -->
    <link rel="apple-touch-icon" href="https://placehold.co/180x180/007bff/ffffff?text=ğŸ“‹">
    <!-- Web App Manifest (Android PWAè¨­å®šç”¨) -->
    <link rel="manifest" href="/manifest.json">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        body {
            font-family: 'Inter', 'Yu Gothic', 'Meiryo', sans-serif; /* æ—¥æœ¬èªãƒ•ã‚©ãƒ³ãƒˆã‚’å„ªå…ˆ */
            background-color: #f3f4f6; /* Light gray background */
            color: #333;
        }
        /* Custom scrollbar for table container */
        .overflow-x-auto::-webkit-scrollbar {
            height: 8px;
        }
        .overflow-x-auto::-webkit-scrollbar-track {
            background: #e2e8f0; /* bg-gray-200 */
            border-radius: 10px;
        }
        .overflow-x-auto::-webkit-scrollbar-thumb {
            background: #94a3b8; /* bg-slate-400 */
            border-radius: 10px;
        }
        .overflow-x-auto::-webkit-scrollbar-thumb:hover {
            background: #64748b; /* bg-slate-600 */
        }
        /* Style for the element to be captured as PDF (hidden from view) */
        /* PDFã®A4ã‚µã‚¤ã‚ºã«è¿‘ã¥ã‘ã‚‹ãŸã‚ã®åŸºæº–è¨­å®š (ç´„ 794px x 1123px @96DPI) */
        /* padding ã¯ html2canvas ã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã«ã‚‚å½±éŸ¿ã™ã‚‹ãŸã‚ã€å†…å´ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã§èª¿æ•´ */
        #pdf-export-content {
            position: absolute;
            left: -9999px; /* Off-screen */
            top: -9999px; /* Off-screen */
            width: 210mm; /* A4 width */
            height: 297mm; /* A4 height */
            box-sizing: border-box; /* paddingã‚’å«ã‚ãŸã‚µã‚¤ã‚º */
            background-color: #ffffff; /* Ensure white background for PDF */
            font-family: 'Yu Gothic', 'Meiryo', 'Inter', sans-serif; /* PDFå‡ºåŠ›æ™‚ã®æ—¥æœ¬èªãƒ•ã‚©ãƒ³ãƒˆå„ªå…ˆ */
            color: #333;
            /* overflow: hidden; /* ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒã¯ã¿å‡ºã•ãªã„ã‚ˆã†ã« */
        }
    </style>
</head>
<body>
    <div id="root"></div>
    <!-- PDFå‡ºåŠ›ç”¨ã«ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹éè¡¨ç¤ºã®è¦ç´  -->
    <div id="pdf-export-content"></div>

    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel for JSX transpilation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
        const { useState, useEffect, useCallback, useRef } = React;
        const { jsPDF } = window.jspdf;

        // ã‚°ãƒ­ãƒ¼ãƒãƒ«ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ (Appã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å†…éƒ¨ã§å®šç¾©ã•ã‚Œã‚‹ã‚¹ãƒ†ãƒ¼ãƒˆã«ä¾å­˜)
        const GlobalMessageModal = ({ show, content, onClose }) => {
            if (!show) return null;
            return (
                <div className="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 p-4">
                    <div className="bg-white rounded-lg shadow-xl p-6 max-w-sm w-full text-center">
                        <p className="text-lg font-semibold text-gray-800 mb-4">{content}</p>
                        <button
                            onClick={onClose}
                            className="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-lg transition duration-300 ease-in-out transform hover:scale-105"
                        >
                            é–‰ã˜ã‚‹
                        </button>
                    </div>
                </div>
            );
        };

        // è¦‹ç©æ›¸ä½œæˆãƒšãƒ¼ã‚¸ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
        const QuotationPage = ({ productData, showMessageModal }) => {
            // State for invoice details
            const [recipientCompanyName, setRecipientCompanyName] = useState('æ ªå¼ä¼šç¤¾ å¾¡ä¸­');
            const [issueDate, setIssueDate] = useState(new Date().toISOString().slice(0, 10)); // Sumatra-MM-DD
            const [subject, setSubject] = useState('ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ');
            const [deliveryDate, setDeliveryDate] = useState('2022-04-30'); // Sumatra-MM-DD
            const [paymentTerms, setPaymentTerms] = useState('æœˆæœ«ç· ç¿Œæœˆæœ«æ‰•');
            const [validityPeriod, setValidityPeriod] = useState('å¾¡è¦‹ç©å¾Œ2é€±é–“');

            // State for sender details (from PDF)
            const [senderCompanyName, setSenderCompanyName] = useState('Ishi.company');
            const [senderAddress, setSenderAddress] = useState('ã€’006-0835\næœ­å¹Œå¸‚æ‰‹ç¨²åŒºæ›™\n5æ¡3ä¸ç›®3-21-102');
            const [senderTel, setSenderTel] = useState('TEL: 080-4508-1220');
            const [senderRepresentative, setSenderRepresentative] = useState('ä»£è¡¨:çŸ³äº•è²¢');

            // State for invoice items
            const [items, setItems] = useState([]);

            // State for totals
            const [subtotal, setSubtotal] = useState(0);
            const [tax, setTax] = useState(0);
            const [total, setTotal] = useState(0);
            const [remarks, setRemarks] = useState('');

            // Tax rate (10% from PDF example)
            const TAX_RATE = 0.10;

            // åˆæœŸã‚¢ã‚¤ãƒ†ãƒ ã®è¨­å®š (productDataãŒãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸå¾Œã«å®Ÿè¡Œ)
            useEffect(() => {
                if (productData && productData.length > 0 && items.length === 0) {
                    setItems([
                        { id: 1, description: productData[0].name, quantity: 1, unit: productData[0].unit, unitPrice: productData[0].price, amount: 0 },
                    ]);
                }
            }, [productData, items.length]);

            // Function to calculate amounts and totals
            const calculateTotals = useCallback(() => {
                let currentSubtotal = 0;
                const updatedItems = items.map(item => {
                    const qty = parseFloat(item.quantity) || 0;
                    const price = parseFloat(item.unitPrice) || 0;
                    const itemAmount = qty * price;
                    currentSubtotal += itemAmount;
                    return { ...item, amount: itemAmount };
                });

                setSubtotal(currentSubtotal);
                setTax(Math.floor(currentSubtotal * TAX_RATE)); // Round tax down to integer
                setTotal(currentSubtotal + Math.floor(currentSubtotal * TAX_RATE));
            }, [items]);

            // Recalculate totals whenever items change
            useEffect(() => {
                calculateTotals();
            }, [items, calculateTotals]);

            // Handle item input changes
            const handleItemChange = (id, field, value) => {
                setItems(prevItems =>
                    prevItems.map(item => {
                        if (item.id === id) {
                            const updatedItem = { ...item, [field]: value };
                            // If description (product name) changes, update unit and unitPrice
                            if (field === 'description') {
                                const selectedProduct = productData.find(p => p.name === value);
                                if (selectedProduct) {
                                    updatedItem.unit = selectedProduct.unit;
                                    updatedItem.unitPrice = selectedProduct.price;
                                } else {
                                    // Reset unit and unitPrice if no matching product found or "é¸æŠã—ã¦ãã ã•ã„" is chosen
                                    updatedItem.unit = '';
                                    updatedItem.unitPrice = 0;
                                }
                            }
                            return updatedItem;
                        }
                        return item;
                    })
                );
            };

            // Add a new item row
            const addItem = () => {
                const newId = items.length > 0 ? Math.max(...items.map(item => item.id)) + 1 : 1;
                // Add new item with the first product from productData (if available)
                const defaultProductForNewItem = productData.length > 0 ? productData[0] : { name: '', unit: '', price: 0 };
                setItems(prevItems => [
                    ...prevItems,
                    { id: newId, description: defaultProductForNewItem.name, quantity: 1, unit: defaultProductForNewItem.unit, unitPrice: defaultProductForNewItem.price, amount: 0 }
                ]);
            };

            // Delete an item row
            const deleteItem = (id) => {
                setItems(prevItems => prevItems.filter(item => item.id !== id));
            };

            // Helper for formatting numbers with commas
            const formatNumber = (num) => num.toLocaleString('ja-JP');

            // PDFå‡ºåŠ›å‡¦ç†
            const handleGeneratePdf = async () => {
                // PDFå‡ºåŠ›ç”¨ã«ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ç”Ÿæˆ
                // ã“ã“ã§PDFã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã«åˆã‚ã›ã¦HTMLã¨ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚¹ã‚¿ã‚¤ãƒ«ã‚’å³å¯†ã«å®šç¾©
                const quotationHtml = `
                    <div style="width: 190mm; /* A4 width - å·¦å³ä½™ç™½ (210mm - 20mm) */
                                margin: 0 auto; /* ä¸­å¤®æƒãˆ */
                                padding: 10mm; /* ä¸Šä¸‹å·¦å³ã®ä½™ç™½ */
                                box-sizing: border-box;
                                font-family: 'Yu Gothic', 'Meiryo', 'Inter', sans-serif;
                                color: #333;
                                line-height: 1.5;">

                        <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 25px;">
                            <div style="font-size: 16px; font-weight: bold; margin-top: 50px;">
                                ${recipientCompanyName}
                                <span style="font-size: 14px; font-weight: normal; margin-left: 5px;">å¾¡ä¸­</span>
                            </div>
                            <div style="text-align: right;">
                                <div style="font-size: 12px; margin-top: 10px;">å¹´æœˆ æ—¥</div>
                                <div style="font-size: 28px; font-weight: bold; margin-top: -5px;">è¦‹ç©æ›¸</div>
                                <div style="font-size: 12px; margin-top: 20px; line-height: 1.4;">
                                    <div style="font-weight: bold;">${senderCompanyName}</div>
                                    <div>${senderAddress.replace(/\n/g, '<br/>')}</div>
                                    <div>${senderTel}</div>
                                    <div>${senderRepresentative}</div>
                                </div>
                            </div>
                        </div>

                        <p style="text-align: center; margin-bottom: 20px; font-size: 14px;">
                            ä¸‹è¨˜ã®ã¨ãŠã‚Šã€å¾¡è¦‹ç©ã‚‚ã‚Šç”³ã—ä¸Šã’ã¾ã™ã€‚
                        </p>

                        <div style="width: 80%; margin: 0 auto 30px auto; border: 1px solid #ddd; padding: 10px; box-sizing: border-box; background-color: #f9f9f9;">
                            <table style="width: 100%; border-collapse: collapse;">
                                <tr>
                                    <td style="width: 20%; padding: 5px; font-weight: bold; font-size: 13px;">ä»¶å</td>
                                    <td style="width: 80%; padding: 5px; border-bottom: 1px dashed #ccc; font-size: 13px;">${subject}</td>
                                </tr>
                                <tr>
                                    <td style="padding: 5px; font-weight: bold; font-size: 13px;">ç´æœŸ</td>
                                    <td style="padding: 5px; border-bottom: 1px dashed #ccc; font-size: 13px;">${deliveryDate}</td>
                                </tr>
                                <tr>
                                    <td style="padding: 5px; font-weight: bold; font-size: 13px;">æ”¯æ‰•æ¡ä»¶</td>
                                    <td style="padding: 5px; border-bottom: 1px dashed #ccc; font-size: 13px;">${paymentTerms}</td>
                                </tr>
                                <tr>
                                    <td style="padding: 5px; font-weight: bold; font-size: 13px;">æœ‰åŠ¹æœŸé™</td>
                                    <td style="padding: 5px; border-bottom: 1px dashed #ccc; font-size: 13px;">${validityPeriod}</td>
                                </tr>
                            </table>
                        </div>

                        <div style="text-align: right; margin-bottom: 20px;">
                            <span style="font-size: 16px; font-weight: bold; margin-right: 10px;">åˆè¨ˆ</span>
                            <span style="font-size: 28px; font-weight: bold; color: #d9534f;">${formatNumber(total)} å††<span style="font-size: 14px; font-weight: normal; margin-left: 5px;">(ç¨è¾¼)</span></span>
                        </div>

                        <table style="width: 100%; border-collapse: collapse; margin-bottom: 30px; border: 1px solid #000;">
                            <thead>
                                <tr style="background-color: #f2f2f2;">
                                    <th style="border: 1px solid #000; padding: 8px; text-align: left; font-size: 12px; width: 40%;">æ‘˜è¦</th>
                                    <th style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px; width: 10%;">æ•°é‡</th>
                                    <th style="border: 1px solid #000; padding: 8px; text-align: center; font-size: 12px; width: 10%;">å˜ä½</th>
                                    <th style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px; width: 20%;">å˜ä¾¡</th>
                                    <th style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px; width: 20%;">é‡‘é¡</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${items.map(item => `
                                    <tr>
                                        <td style="border: 1px solid #000; padding: 8px; text-align: left; font-size: 12px;">${item.description}</td>
                                        <td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${item.quantity}</td>
                                        <td style="border: 1px solid #000; padding: 8px; text-align: center; font-size: 12px;">${item.unit}</td>
                                        <td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${formatNumber(item.unitPrice)}</td>
                                        <td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${formatNumber(item.amount)}</td>
                                    </tr>
                                `).join('')}
                                <!-- å°è¨ˆãƒ»æ¶ˆè²»ç¨ãƒ»åˆè¨ˆ -->
                                <tr>
                                    <td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: left;"></td>
                                    <td style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: bold; font-size: 12px;">å°è¨ˆ</td>
                                    <td style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: bold; font-size: 12px;">${formatNumber(subtotal)}</td>
                                </tr>
                                <tr>
                                    <td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: left;"></td>
                                    <td style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: bold; font-size: 12px;">æ¶ˆè²»ç¨ (${TAX_RATE * 100}%)</td>
                                    <td style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: bold; font-size: 12px;">${formatNumber(tax)}</td>
                                </tr>
                                <tr>
                                    <td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: left;"></td>
                                    <td style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: bold; font-size: 12px;">åˆè¨ˆ</td>
                                    <td style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: bold; font-size: 12px;">${formatNumber(total)}</td>
                                </tr>
                            </tbody>
                        </table>

                        <div style="margin-bottom: 20px;">
                            <p style="font-size: 13px; font-weight: bold; margin-bottom: 5px;">å‚™è€ƒ</p>
                            <div style="border: 1px solid #000; padding: 10px; min-height: 60px; font-size: 12px; white-space: pre-wrap;">
                                ${remarks || ''}
                            </div>
                        </div>

                        <p style="text-align: right; font-size: 10px; margin-top: 30px;">
                            æœ¬è¦‹ç©æ›¸ã®æœ‰åŠ¹æœŸé™ã¯ã€å¾¡è¦‹ç©å¾Œ2é€±é–“ã§ã™ã€‚
                        </p>
                    </div>
                `;

                // ä¸€æ™‚divã«HTMLã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ã‚»ãƒƒãƒˆ
                const tempDiv = document.getElementById('pdf-export-content');
                if (!tempDiv) {
                    showMessageModal('PDFå‡ºåŠ›ç”¨ã®é ˜åŸŸãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚');
                    return;
                }
                tempDiv.innerHTML = quotationHtml; // ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ç”¨ã®HTMLã‚’ã‚»ãƒƒãƒˆ

                // html2canvasã§HTMLè¦ç´ ã‚’ç”»åƒã¨ã—ã¦ã‚­ãƒ£ãƒ—ãƒãƒ£
                try {
                    showMessageModal('PDFã‚’ç”Ÿæˆä¸­ã§ã™...'); // å‡¦ç†é–‹å§‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
                    const canvas = await html2canvas(tempDiv, {
                        scale: 2, // è§£åƒåº¦ã‚’ä¸Šã’ã‚‹
                        useCORS: true,
                        logging: true,
                        scrollX: 0,
                        scrollY: -window.scrollY // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä½ç½®ã‚’è€ƒæ…®
                    });

                    const imgData = canvas.toDataURL('image/png');
                    const pdf = new jsPDF('p', 'mm', 'a4'); // 'p' for portrait, 'mm' for millimeters, 'a4' for A4 size
                    const imgWidth = 210; // A4 width in mm
                    const pageHeight = 297; // A4 height in mm
                    
                    // imgHeightã‚’è¨ˆç®—ã—ã€1ãƒšãƒ¼ã‚¸ã«åã¾ã‚‹ã‚ˆã†ã«èª¿æ•´
                    // å¿…è¦ã§ã‚ã‚Œã°imgWidthã‚’åŸºæº–ã«é«˜ã•ã‚’èª¿æ•´
                    const imgHeight = canvas.height * imgWidth / canvas.width;

                    // 1ãƒšãƒ¼ã‚¸ã®ã¿ã‚’è¿½åŠ 
                    pdf.addImage(imgData, 'PNG', 0, 0, imgWidth, imgHeight);

                    // ãƒ•ã‚¡ã‚¤ãƒ«åã‚’ã€Œä»¶å_å®›å.pdfã€ã«å¤‰æ›´
                    const fileName = `${subject}_${recipientCompanyName}.pdf`;
                    pdf.save(fileName);
                    showMessageModal('PDFãŒç”Ÿæˆã•ã‚Œã¾ã—ãŸï¼');
                } catch (error) {
                    console.error('PDFç”Ÿæˆã‚¨ãƒ©ãƒ¼:', error);
                    showMessageModal(`PDFç”Ÿæˆä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ${error.message}`);
                } finally {
                    tempDiv.innerHTML = ''; // ä¸€æ™‚divã®å†…å®¹ã‚’ã‚¯ãƒªã‚¢
                }
            };


            return (
                <div className="bg-white p-6 sm:p-10 rounded-xl shadow-2xl w-full border border-gray-200">
                    <h1 className="text-3xl sm:text-4xl font-bold text-center text-gray-800 mb-8 pb-4 border-b-2 border-blue-200">è¦‹ç©æ›¸</h1>

                    {/* Header Section */}
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                        <div className="flex flex-col space-y-2">
                            <label className="text-sm font-semibold text-gray-600">å®›å:</label>
                            <input
                                type="text"
                                className="p-2 border border-gray-300 rounded-md text-base focus:ring-blue-500 focus:border-blue-500"
                                value={recipientCompanyName}
                                onChange={(e) => setRecipientCompanyName(e.target.value)}
                            />
                            <span className="text-xl font-bold ml-1">å¾¡ä¸­</span>
                        </div>

                        <div className="flex flex-col items-end space-y-2">
                            <label className="text-sm font-semibold text-gray-600">æ—¥ä»˜:</label>
                            <input
                                type="date"
                                className="p-2 border border-gray-300 rounded-md text-base text-right focus:ring-blue-500 focus:border-blue-500"
                                value={issueDate}
                                onChange={(e) => setIssueDate(e.target.value)}
                            />
                            {/* Sender Information */}
                            <div className="text-right text-sm">
                                <input
                                    type="text"
                                    className="font-bold text-md mb-1 w-full text-right p-1 border border-gray-300 rounded-md"
                                    value={senderCompanyName}
                                    onChange={(e) => setSenderCompanyName(e.target.value)}
                                />
                                <textarea
                                    className="w-full text-right p-1 border border-gray-300 rounded-md text-sm resize-y"
                                    rows="3"
                                    value={senderAddress}
                                    onChange={(e) => setSenderAddress(e.target.value)}
                                ></textarea>
                                <input
                                    type="text"
                                    className="w-full text-right p-1 border border-gray-300 rounded-md text-sm"
                                    value={senderTel}
                                    onChange={(e) => setSenderTel(e.target.value)}
                                />
                                <input
                                    type="text"
                                    className="w-full text-right p-1 border border-gray-300 rounded-md text-sm"
                                    value={senderRepresentative}
                                    onChange={(e) => setSenderRepresentative(e.target.value)}
                                />
                            </div>
                        </div>
                    </div>

                    <p className="mb-6 text-center text-gray-700 text-lg">ä¸‹è¨˜ã®ã¨ãŠã‚Šã€å¾¡è¦‹ç©ã‚‚ã‚Šç”³ã—ä¸Šã’ã¾ã™ã€‚</p>

                    {/* Key Details Section */}
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-8 p-4 bg-blue-50 rounded-lg border border-blue-200">
                        <div className="flex flex-col">
                            <label className="text-sm font-semibold text-blue-700 mb-1">ä»¶å:</label>
                            <input
                                type="text"
                                className="p-2 border border-blue-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                                value={subject}
                                onChange={(e) => setSubject(e.target.value)}
                            />
                        </div>
                        <div className="flex flex-col">
                            <label className="text-sm font-semibold text-blue-700 mb-1">ç´æœŸ:</label>
                            <input
                                type="date"
                                className="p-2 border border-blue-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                                value={deliveryDate}
                                onChange={(e) => setDeliveryDate(e.target.value)}
                            />
                        </div>
                        <div className="flex flex-col">
                            <label className="text-sm font-semibold text-blue-700 mb-1">æ”¯æ‰•æ¡ä»¶:</label>
                            <input
                                type="text"
                                className="p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                                value={paymentTerms}
                                onChange={(e) => setPaymentTerms(e.target.value)}
                            />
                        </div>
                        <div className="flex flex-col lg:col-span-1"> {/* Adjusted to span 1 column on large screens */}
                            <label className="text-sm font-semibold text-blue-700 mb-1">æœ‰åŠ¹æœŸé™:</label>
                            <input
                                type="text"
                                className="p-2 border border-blue-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                                value={validityPeriod}
                                onChange={(e) => setValidityPeriod(e.target.value)}
                            />
                        </div>
                    </div>

                    {/* Total Amount Display */}
                    <div className="flex justify-end items-baseline mb-8">
                        <span className="text-xl sm:text-2xl font-bold mr-4 text-gray-700">åˆè¨ˆ</span>
                        <span className="text-3xl sm:text-4xl font-extrabold text-blue-600">
                            {formatNumber(total)} å†† (ç¨è¾¼)
                        </span>
                    </div>

                    {/* Items Table */}
                    <div className="overflow-x-auto mb-8 shadow-md rounded-lg border border-gray-200">
                        <table className="min-w-full divide-y divide-gray-200">
                            <thead className="bg-blue-50">
                                <tr>
                                    <th className="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-1/12"></th> {/* Delete button column */}
                                    <th className="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-4/12">æ‘˜è¦</th>
                                    <th className="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-1/12">æ•°é‡</th>
                                    <th className="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-1/12">å˜ä½</th>
                                    <th className="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-2/12">å˜ä¾¡</th>
                                    <th className="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-2/12">é‡‘é¡</th>
                                </tr>
                            </thead>
                            <tbody className="bg-white divide-y divide-gray-200">
                                {items.map(item => (
                                    <tr key={item.id}>
                                        <td className="px-3 py-3 whitespace-nowrap">
                                            <button
                                                onClick={() => deleteItem(item.id)}
                                                className="p-1 rounded-full bg-red-500 text-white hover:bg-red-600 transition duration-200"
                                                title="é …ç›®ã‚’å‰Šé™¤"
                                            >
                                                <svg xmlns="http://www.w3.org/2000/svg" className="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M6 18L18 6M6 6l12 12" />
                                                </svg>
                                            </button>
                                        </td>
                                        <td className="px-3 py-3 whitespace-nowrap text-sm text-gray-900">
                                            {/* å•†å“åãƒ—ãƒ«ãƒ€ã‚¦ãƒ³ */}
                                            <select
                                                className="w-full p-1 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                                                value={item.description}
                                                onChange={(e) => handleItemChange(item.id, 'description', e.target.value)}
                                                disabled={productData.length === 0}
                                            >
                                                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                                                {productData.map(product => (
                                                    <option key={product.id} value={product.name}>{product.name}</option>
                                                ))}
                                            </select>
                                        </td>
                                        <td className="px-3 py-3 whitespace-nowrap text-sm text-gray-900">
                                            <input
                                                type="number"
                                                className="w-full p-1 border border-gray-300 rounded-md text-right focus:ring-blue-500 focus:border-blue-500"
                                                value={item.quantity}
                                                onChange={(e) => handleItemChange(item.id, 'quantity', e.target.value)}
                                                min="0"
                                            />
                                        </td>
                                        <td className="px-3 py-3 whitespace-nowrap text-sm text-gray-900">
                                            <input
                                                type="text"
                                                className="w-full p-1 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 bg-gray-50"
                                                value={item.unit}
                                                onChange={(e) => handleItemChange(item.id, 'unit', e.target.value)}
                                                readOnly={true} // Set to readOnly
                                            />
                                        </td>
                                        <td className="px-3 py-3 whitespace-nowrap text-sm text-gray-900">
                                            <input
                                                type="number"
                                                className="w-full p-1 border border-gray-300 rounded-md text-right focus:ring-blue-500 focus:border-blue-500 bg-gray-50"
                                                value={item.unitPrice}
                                                onChange={(e) => handleItemChange(item.id, 'unitPrice', e.target.value)}
                                                min="0"
                                                readOnly={true} // Set to readOnly
                                            />
                                        </td>
                                        <td className="px-3 py-3 whitespace-nowrap text-sm text-gray-900 text-right font-medium bg-gray-50">
                                            {formatNumber(item.amount)}
                                        </td>
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                    </div>

                    <div className="flex justify-between items-center mb-8">
                        <button
                            onClick={addItem}
                            className="px-6 py-2 bg-blue-600 text-white font-bold rounded-lg shadow-md hover:bg-blue-700 transition duration-300 transform hover:scale-105"
                        >
                            é …ç›®ã‚’è¿½åŠ 
                        </button>
                        <div className="flex space-x-2"> {/* ãƒœã‚¿ãƒ³ã‚’æ¨ªä¸¦ã³ã«ã™ã‚‹ãŸã‚ã®ã‚³ãƒ³ãƒ†ãƒŠ */}
                            <button
                                onClick={handleGeneratePdf}
                                className="px-6 py-2 bg-red-600 text-white font-bold rounded-lg shadow-md hover:bg-red-700 transition duration-300 transform hover:scale-105"
                            >
                                PDFå‡ºåŠ›
                            </button>
                        </div>
                    </div>


                    {/* Totals Section */}
                    <div className="flex justify-end mb-8">
                        <div className="w-full max-w-sm">
                            <div className="flex justify-between items-center py-2 border-b border-gray-200">
                                <span className="text-md sm:text-lg text-gray-700">å°è¨ˆ:</span>
                                <span className="text-md sm:text-lg font-semibold text-gray-800">{formatNumber(subtotal)} å††</span>
                            </div>
                            <div className="flex justify-between items-center py-2 border-b border-gray-200">
                                <span className="text-md sm:text-lg text-gray-700">æ¶ˆè²»ç¨ ({TAX_RATE * 100}%):</span>
                                <span className="text-md sm:text-lg font-semibold text-gray-800">{formatNumber(tax)} å††</span>
                            </div>
                            <div className="flex justify-between items-center py-3 font-bold text-lg sm:text-xl border-t-2 border-blue-300 mt-2">
                                <span>åˆè¨ˆ:</span>
                                <span>{formatNumber(total)} å††</span>
                            </div>
                        </div>
                    </div>

                    {/* Remarks Section */}
                    <div className="mb-8">
                        <label htmlFor="remarks" className="block text-md font-semibold text-gray-700 mb-2">å‚™è€ƒ:</label>
                        <textarea
                            id="remarks"
                            className="w-full p-3 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 resize-y"
                            rows="4"
                            value={remarks}
                            onChange={(e) => setRemarks(e.target.value)}
                            placeholder="ã”ä¸æ˜ãªç‚¹ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ãŠæ°—è»½ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚"
                        ></textarea>
                    </div>

                    <p className="text-center text-gray-500 text-sm mt-8">æœ¬è¦‹ç©æ›¸ã®æœ‰åŠ¹æœŸé™ã¯ã€å¾¡è¦‹ç©å¾Œ2é€±é–“ã§ã™ã€‚</p>

                </div>
            );
        };

        // å•†å“ç®¡ç†ãƒšãƒ¼ã‚¸ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
        const ProductManagementPage = ({ productData, addProduct, updateProduct, deleteProduct, showMessageModal }) => {
            const [editingProduct, setEditingProduct] = useState(null); // ç·¨é›†ä¸­å•†å“ã®ID
            const [newProductName, setNewProductName] = useState('');
            const [newProductUnit, setNewProductUnit] = useState('');
            const [newProductPrice, setNewProductPrice] = useState('');

            // ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ ã‚’ãƒªã‚»ãƒƒãƒˆã™ã‚‹é–¢æ•°
            const resetForm = () => {
                setEditingProduct(null);
                setNewProductName('');
                setNewProductUnit('');
                setNewProductPrice('');
            };

            // ç·¨é›†ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯æ™‚ã®å‡¦ç†
            const handleEditClick = (product) => {
                setEditingProduct(product.id);
                setNewProductName(product.name);
                setNewProductUnit(product.unit);
                setNewProductPrice(product.price);
            };

            // å•†å“è¿½åŠ ãƒ»æ›´æ–°ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯æ™‚ã®å‡¦ç†
            const handleSubmit = (e) => {
                e.preventDefault();
                if (!newProductName || !newProductUnit || newProductPrice === '') {
                    showMessageModal('å•†å“åã€å˜ä½ã€å˜ä¾¡ã¯å¿…é ˆã§ã™ã€‚'); // ã‚«ã‚¹ã‚¿ãƒ ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’ä½¿ç”¨
                    return;
                }
                const price = parseFloat(newProductPrice);
                if (isNaN(price) || price < 0) {
                    showMessageModal('å˜ä¾¡ã¯0ä»¥ä¸Šã®æ•°å€¤ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚'); // ã‚«ã‚¹ã‚¿ãƒ ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’ä½¿ç”¨
                    return;
                }

                if (editingProduct) {
                    // æ›´æ–°å‡¦ç†
                    updateProduct({ id: editingProduct, name: newProductName, unit: newProductUnit, price: price });
                } else {
                    // è¿½åŠ å‡¦ç†
                    addProduct({ name: newProductName, unit: newProductUnit, price: price });
                }
                resetForm();
            };

            return (
                <div className="bg-white p-6 sm:p-10 rounded-xl shadow-2xl w-full border border-gray-200">
                    <h1 className="text-3xl sm:text-4xl font-bold text-center text-gray-800 mb-8 pb-4 border-b-2 border-blue-200">å•†å“ç®¡ç†</h1>

                    {/* å•†å“è¿½åŠ ãƒ»ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ  */}
                    <form onSubmit={handleSubmit} className="mb-8 p-4 border border-blue-200 rounded-lg bg-blue-50">
                        <h2 className="text-2xl font-semibold text-blue-700 mb-4">{editingProduct ? 'å•†å“ã‚’ä¿®æ­£' : 'æ–°ã—ã„å•†å“ã‚’è¿½åŠ '}</h2>
                        <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                            <div className="flex flex-col">
                                <label htmlFor="productName" className="text-sm font-semibold text-gray-700 mb-1">å•†å“å:</label>
                                <input
                                    type="text"
                                    id="productName"
                                    className="p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                                    value={newProductName}
                                    onChange={(e) => setNewProductName(e.target.value)}
                                    required
                                />
                            </div>
                            <div className="flex flex-col">
                                <label htmlFor="productUnit" className="text-sm font-semibold text-gray-700 mb-1">å˜ä½:</label>
                                <input
                                    type="text"
                                    id="productUnit"
                                    className="p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                                    value={newProductUnit}
                                    onChange={(e) => setNewProductUnit(e.target.value)}
                                    required
                                />
                            </div>
                            <div className="flex flex-col">
                                <label htmlFor="productPrice" className="text-sm font-semibold text-gray-700 mb-1">å˜ä¾¡:</label>
                                <input
                                    type="number"
                                    id="productPrice"
                                    className="p-2 border border-gray-300 rounded-md text-right focus:ring-blue-500 focus:border-blue-500"
                                    value={newProductPrice}
                                    onChange={(e) => setNewProductPrice(e.target.value)}
                                    min="0"
                                    required
                                />
                            </div>
                        </div>
                        <div className="flex justify-end space-x-2">
                            {editingProduct && (
                                <button
                                    type="button"
                                    onClick={resetForm}
                                    className="px-4 py-2 bg-gray-500 text-white font-bold rounded-lg shadow-md hover:bg-gray-600 transition duration-300"
                                >
                                    ã‚­ãƒ£ãƒ³ã‚»ãƒ«
                                </button>
                            )}
                            <button
                                type="submit"
                                className="px-4 py-2 bg-blue-600 text-white font-bold rounded-lg shadow-md hover:bg-blue-700 transition duration-300 transform hover:scale-105"
                            >
                                {editingProduct ? 'æ›´æ–°' : 'è¿½åŠ '}
                            </button>
                        </div>
                    </form>

                    {/* å•†å“ä¸€è¦§ãƒ†ãƒ¼ãƒ–ãƒ« */}
                    <h2 className="text-2xl font-semibold text-gray-800 mb-4">ç™»éŒ²å•†å“ä¸€è¦§</h2>
                    {productData.length === 0 ? (
                        <p className="text-center text-gray-600 italic py-4">ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹å•†å“ãŒã‚ã‚Šã¾ã›ã‚“ã€‚</p>
                    ) : (
                        <div className="overflow-x-auto shadow-md rounded-lg border border-gray-200">
                            <table className="min-w-full divide-y divide-gray-200">
                                <thead className="bg-blue-50">
                                    <tr>
                                        <th className="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">å•†å“å</th>
                                        <th className="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">å˜ä½</th>
                                        <th className="px-3 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">å˜ä¾¡</th>
                                        <th className="px-3 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">æ“ä½œ</th>
                                    </tr>
                                </thead>
                                <tbody className="bg-white divide-y divide-gray-200">
                                    {productData.map(product => (
                                        <tr key={product.id}>
                                            <td className="px-3 py-3 whitespace-nowrap text-sm text-gray-900">{product.name}</td>
                                            <td className="px-3 py-3 whitespace-nowrap text-sm text-gray-900">{product.unit}</td>
                                            <td className="px-3 py-3 whitespace-nowrap text-sm text-gray-900 text-right">{product.price.toLocaleString('ja-JP')}</td>
                                            <td className="px-3 py-3 whitespace-nowrap text-center text-sm">
                                                <button
                                                    onClick={() => handleEditClick(product)}
                                                    className="inline-flex items-center px-3 py-1 bg-yellow-500 text-white text-xs font-bold rounded-md shadow-sm hover:bg-yellow-600 transition duration-200 mr-2"
                                                >
                                                    <svg xmlns="http://www.w3.org/2000/svg" className="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-7-6l-2-2m2 2l5 5m-5-2l2 2m-2-2l-2-2M15 4l2 2m-2-2l-2 2" />
                                                    </svg>
                                                    ç·¨é›†
                                                </button>
                                                <button
                                                    onClick={() => {
                                                        // confirmã‚’ã‚«ã‚¹ã‚¿ãƒ ãƒ¢ãƒ¼ãƒ€ãƒ«ã«ç½®ãæ›ãˆ
                                                        if (confirm('ã“ã®å•†å“ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) { // confirmã¯ä¸€æ™‚çš„ã«æ®‹ã™
                                                            deleteProduct(product.id);
                                                        }
                                                    }}
                                                    className="inline-flex items-center px-3 py-1 bg-red-500 text-white text-xs font-bold rounded-md shadow-sm hover:bg-red-600 transition duration-200"
                                                >
                                                    <svg xmlns="http://www.w3.org/2000/svg" className="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                                                    </svg>
                                                    å‰Šé™¤
                                                </button>
                                            </td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>
                    )}
                </div>
            );
        };


        const App = () => {
            // ã‚°ãƒ­ãƒ¼ãƒãƒ«ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚¹ãƒ†ãƒ¼ãƒˆã‚’Appã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†…ã«ç§»å‹•
            const [globalShowMessageModal, setGlobalShowMessageModal] = useState(false);
            const [globalModalContent, setGlobalModalContent] = useState('');

            // showMessageModalé–¢æ•°ã‚‚Appã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†…ã«ç§»å‹•
            const showMessageModal = (content) => {
                setGlobalModalContent(content);
                setGlobalShowMessageModal(true);
            };

            // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰å•†å“ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ­ãƒ¼ãƒ‰ã€ãªã‘ã‚Œã°ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨
            const loadProductDataFromLocalStorage = () => {
                try {
                    const savedData = localStorage.getItem('productData');
                    if (savedData) {
                        const parsedData = JSON.parse(savedData);
                        // Ensure each product has an 'id' for keying in React
                        return parsedData.map(p => ({ ...p, id: p.id || Date.now() + Math.random() }));
                    }
                } catch (error) {
                    console.error("Failed to load product data from localStorage:", error);
                    showMessageModal("å•†å“ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚");
                }
                // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ãƒ‡ãƒ¼ã‚¿ãŒãªã„å ´åˆã€ã¾ãŸã¯èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ãŸå ´åˆã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‡ãƒ¼ã‚¿
                const defaultProducts = [
                    { name: 'ã‚µãƒ³ãƒ—ãƒ«15', unit: 'å€‹', price: 15000 },
                    { name: 'ã‚µãƒ³ãƒ—ãƒ«16', unit: 'å¼', price: 16000 },
                    { name: 'ã‚µãƒ³ãƒ—ãƒ«17', unit: 'æš', price: 17000 },
                    { name: 'ã‚µãƒ³ãƒ—ãƒ«18', unit: 'å›', price: 18000 },
                    { name: 'ã‚µãƒ³ãƒ—ãƒ«19', unit: 'ã‚»ãƒƒãƒˆ', price: 19000 },
                    { name: 'ã‚µãƒ³ãƒ—ãƒ«20', unit: 'æœ¬', price: 20000 },
                    { name: 'ã‚µãƒ³ãƒ—ãƒ«21', unit: 'å¼', price: 21000 },
                    { name: 'ã‚µãƒ³ãƒ—ãƒ«22', unit: 'å€‹', price: 22000 },
                    { name: 'ã‚µãƒ³ãƒ—ãƒ«23', unit: 'æš', price: 23000 },
                    { name: 'ã‚µãƒ³ãƒ—ãƒ«24', unit: 'å¼', price: 24000 },
                    { name: 'ã‚µãƒ³ãƒ—ãƒ«25', unit: 'æœ¬', price: 25000 },
                ];
                // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‡ãƒ¼ã‚¿ã«ã‚‚ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªIDã‚’ä»˜ä¸
                return defaultProducts.map((p, index) => ({ ...p, id: Date.now() + index + Math.random() })); // å¿µã®ãŸã‚Date.now() + index + random
            };

            const [productData, setProductData] = useState(loadProductDataFromLocalStorage());
            const [currentPage, setCurrentPage] = useState('quotation'); // 'quotation' or 'management'

            // productDataãŒå¤‰æ›´ã•ã‚Œã‚‹ãŸã³ã«Local Storageã«ä¿å­˜
            useEffect(() => {
                try {
                    localStorage.setItem('productData', JSON.stringify(productData));
                } catch (error) {
                    console.error("Failed to save product data to localStorage:", error);
                    showMessageModal("å•†å“ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸã€‚");
                }
            }, [productData]);

            // å•†å“ã‚’è¿½åŠ ã™ã‚‹é–¢æ•°
            const addProduct = (newProduct) => {
                // æ–°ã—ã„IDã‚’ç”Ÿæˆã€‚æ—¢å­˜ã®IDã®æœ€å¤§å€¤ + 1 ã‚’ä½¿ç”¨ã—ã€é‡è¤‡ã—ãªã„ã‚ˆã†ã«ã™ã‚‹
                const newId = productData.length > 0 ? Math.max(...productData.map(p => p.id)) + 1 : 1;
                setProductData(prevData => [...prevData, { ...newProduct, id: newId }]);
                showMessageModal('å•†å“ãŒè¿½åŠ ã•ã‚Œã¾ã—ãŸã€‚'); // è¿½åŠ æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
            };

            // å•†å“ã‚’æ›´æ–°ã™ã‚‹é–¢æ•°
            const updateProduct = (updatedProduct) => {
                setProductData(prevData =>
                    prevData.map(p => (p.id === updatedProduct.id ? updatedProduct : p))
                );
                showMessageModal('å•†å“ãŒæ›´æ–°ã•ã‚Œã¾ã—ãŸã€‚'); // æ›´æ–°æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
            };

            // å•†å“ã‚’å‰Šé™¤ã™ã‚‹é–¢æ•°
            const deleteProduct = (id) => {
                setProductData(prevData => prevData.filter(p => p.id !== id));
                showMessageModal('å•†å“ãŒå‰Šé™¤ã•ã‚Œã¾ã—ãŸã€‚'); // å‰Šé™¤æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
            };

            return (
                <div className="min-h-screen p-4 sm:p-8 bg-gray-100 flex justify-center">
                    <div className="w-full max-w-6xl">
                        {/* ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ */}
                        <nav className="mb-6 bg-white p-4 rounded-xl shadow-md flex justify-center space-x-4">
                            <button
                                onClick={() => setCurrentPage('quotation')}
                                className={`px-6 py-2 rounded-lg font-bold transition duration-300 ${
                                    currentPage === 'quotation' ? 'bg-blue-600 text-white shadow-lg' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                                }`}
                            >
                                è¦‹ç©æ›¸ä½œæˆ
                            </button>
                            <button
                                onClick={() => setCurrentPage('management')}
                                className={`px-6 py-2 rounded-lg font-bold transition duration-300 ${
                                    currentPage === 'management' ? 'bg-blue-600 text-white shadow-lg' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                                }`}
                            >
                                å•†å“ç®¡ç†
                            </button>
                        </nav>

                        {/* ãƒšãƒ¼ã‚¸ã®è¡¨ç¤º */}
                        {currentPage === 'quotation' ? (
                            <QuotationPage productData={productData} showMessageModal={showMessageModal} />
                        ) : (
                            <ProductManagementPage
                                productData={productData}
                                addProduct={addProduct}
                                updateProduct={updateProduct}
                                deleteProduct={deleteProduct}
                                showMessageModal={showMessageModal} // showMessageModalã‚’propsã¨ã—ã¦æ¸¡ã™
                            />
                        )}
                    </div>
                    <GlobalMessageModal show={globalShowMessageModal} content={globalModalContent} onClose={() => setGlobalShowMessageModal(false)} /> {/* ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é…ç½® */}
                </div>
            );
        };

        ReactDOM.render(React.createElement(App), document.getElementById('root'));
    </script>
</body>
</html>
